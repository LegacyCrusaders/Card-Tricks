<!-- TIME LOOP PHONE â€“ VERSION 5 -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Phone</title>

<style>
html, body {
  margin:0; padding:0; height:100%;
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
  overflow:hidden; color:white;
}

.screen { position:fixed; inset:0; display:none; justify-content:center; align-items:center; flex-direction:column; }

.active { display:flex; }

#start { background:black; color:white; font-size:26px; }
#start p { margin-top:10px; font-size:16px; opacity:0.7; }

#armed { background:black; }

#incoming, #call {
  width:100%; height:100%;
  display:flex; flex-direction:column; justify-content:center; align-items:center;
  background: linear-gradient(to bottom, #4c7cff, #2b42a6); /* realistic Galaxy call gradient */
  color:white;
}

#incomingName, #callName {
  font-size:32px;
  margin-top:20px;
}

#timer { font-size:18px; margin-top:6px; opacity:0.8; }

.avatar {
  width:90px; height:90px; border-radius:50%; background:#999;
}

.buttons {
  position:absolute; bottom:40px; width:100%; display:flex; justify-content:space-around;
}

.btn {
  width:72px; height:72px; border-radius:50%;
  display:flex; align-items:center; justify-content:center;
  font-weight:bold; font-size:18px; user-select:none;
}

.green { background:#2ecc71; color:black; }
.red { background:#e74c3c; color:white; }

.controls {
  display:grid; grid-template-columns:repeat(3,1fr); gap:20px; margin-top:40px; text-align:center; font-size:14px;
  width:80%;
}

.controls div { background:rgba(255,255,255,0.2); padding:12px; border-radius:12px; }

#log { background:#111; padding:20px; align-items:flex-start; overflow-y:auto; }

.log-item {
  width:100%; padding:14px 0; border-bottom:1px solid #333;
  display:flex; justify-content:space-between; align-items:center;
}

.log-item.callable { cursor:pointer; color:#4c7cff; }
</style>
</head>
<body>

<!-- START -->
<div id="start" class="screen active">
  <h1>Tap to Begin</h1>
  <p>Version 5</p>
</div>

<!-- ARMED -->
<div id="armed" class="screen"></div>

<!-- INCOMING -->
<div id="incoming" class="screen">
  <div class="avatar"></div>
  <h1 id="incomingName">Future Me</h1>
  <p>Incoming Call</p>
  <div class="buttons">
    <div class="btn red" onclick="endToLog()">Decline</div>
    <div class="btn green" onclick="answerIncoming()">Answer</div>
  </div>
</div>

<!-- CALL -->
<div id="call" class="screen">
  <div class="avatar"></div>
  <h1 id="callName"></h1>
  <p id="timer">00:00</p>
  <div class="controls">
    <div>Add Call</div>
    <div>Hold</div>
    <div>Bluetooth</div>
    <div>Speaker</div>
    <div>Mute</div>
    <div>Keypad</div>
  </div>
  <div class="buttons">
    <div class="btn red" onclick="hangUp()">End</div>
  </div>
</div>

<!-- LOG -->
<div id="log" class="screen">
  <h1>Recents</h1>
  <div id="logItems"></div>
</div>

<script>
let mode="idle";
let faceDown=false;
let timerInt;
let seconds=0;
let currentCaller="";

// Initial log: Future Me, Mom, Jordan
let log=[
  {name:"Future Me", time:"now", callable:false},
  {name:"Mom", time:"Yesterday", callable:false},
  {name:"Jordan", time:"9:14 AM", callable:false}
];

// Show screen
function show(id){
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

// Tap to begin
async function start(){
  if(!document.fullscreenElement){await document.documentElement.requestFullscreen();}
  if('wakeLock' in navigator){try{await navigator.wakeLock.request('screen');}catch{}}
  show('armed');
  mode="armed";
}
document.getElementById('start').onclick=start;

// Detect flip
window.addEventListener('deviceorientation', e=>{
  if(mode!=="armed") return;
  if(e.beta>150||e.beta<-150){faceDown=true;}
  else if(faceDown){
    faceDown=false;
    mode="locked";
    setTimeout(()=>{
      document.getElementById('incomingName').innerText="Future Me";
      show('incoming');
      navigator.vibrate([200,200,200]);
    },1000);
  }
});

// Answer incoming
function answerIncoming(){ startCall("Future Me"); }

// Generic call starter
function startCall(caller){
  clearInterval(timerInt);
  seconds=0;
  currentCaller=caller;
  document.getElementById('callName').innerText=caller;
  document.getElementById('timer').innerText='00:00';
  show('call');
  timerInt=setInterval(()=>{
    seconds++;
    let m=String(Math.floor(seconds/60)).padStart(2,'0');
    let s=String(seconds%60).padStart(2,'0');
    document.getElementById('timer').innerText=`${m}:${s}`;
  },1000);
}

// Hang up
function hangUp(){
  clearInterval(timerInt);
  // Add Past Me after first call, only if not exist
  if(currentCaller==="Future Me" && !log.find(x=>x.name==="Past Me")){
    log.push({name:"Past Me", time:"now", callable:true});
  }
  // Update mode
  mode="log";
  renderLog();
  show('log');
}

// End without answering
function endToLog(){ renderLog(); show('log'); mode="log"; }

// Render call log
function renderLog(){
  const el=document.getElementById('logItems');
  el.innerHTML="";
  // First time after Future Me hang-up: Future Me top, Past Me bottom
  // After Past Me call-back: Past Me top, Future Me second
  let displayLog=[...log];
  if(log.find(x=>x.name==="Past Me") && mode==="log" && currentCaller==="Past Me"){
    // After calling Past Me: Past Me moves top
    displayLog = log.filter(x=>x.name==="Past Me").concat(log.filter(x=>x.name!=="Past Me"));
  } else if(log.find(x=>x.name==="Past Me") && mode==="log"){
    // First log after Future Me: keep Future Me top, Past Me bottom
    displayLog = log.filter(x=>x.name!=="Past Me").concat(log.filter(x=>x.name==="Past Me"));
  }
  displayLog.forEach(item=>{
    const d=document.createElement('div');
    d.className="log-item"+(item.callable?" callable":"");
    d.innerHTML=`${item.name}<span>${item.time}</span>`;
    if(item.callable) d.onclick=callPast;
    el.appendChild(d);
  });
}

// Call Past Me
function callPast(){ startCall("Past Me"); mode="calling"; }

// Initial render
renderLog();
</script>

</body>
</html>
