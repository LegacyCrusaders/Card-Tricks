<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card Selection</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 400px;
            width: 100%;
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 24px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
            font-size: 14px;
        }

        select {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s;
        }

        select:focus {
            outline: none;
            border-color: #667eea;
        }

        button {
            width: 100%;
            padding: 15px;
            font-size: 18px;
            font-weight: bold;
            color: white;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .message {
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            font-size: 16px;
            display: none;
        }

        .message.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .message.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Make Your Selection</h1>
        
        <div class="form-group">
            <label for="cardSelect">Choose a Card:</label>
            <select id="cardSelect">
                <option value="">-- Select a Card --</option>
            </select>
        </div>

        <div class="form-group">
            <label for="numberSelect">Choose a Number (1-52):</label>
            <select id="numberSelect">
                <option value="">-- Select a Number --</option>
            </select>
        </div>

        <button id="submitBtn" onclick="submitSelection()">Submit Selection</button>

        <div id="message" class="message"></div>
    </div>

    <script>
        const SHEET_URL = 'https://script.google.com/macros/s/AKfycbzZU-2QSO1YD4ogNSUPaxQ3LmVx26OJUGL77JSeBO8AzyQt9Pyx8ryoTwWmKZpM5OPH/exec';

        // Si Stebbins deck order
        const sistebbinsOrder = [
            'Ace of Clubs', '4 of Hearts', '7 of Spades', '10 of Diamonds',
            'King of Clubs', '3 of Hearts', '6 of Spades', '9 of Diamonds',
            'Queen of Clubs', '2 of Hearts', '5 of Spades', '8 of Diamonds',
            'Jack of Clubs', 'Ace of Hearts', '4 of Spades', '7 of Diamonds',
            '10 of Clubs', 'King of Hearts', '3 of Spades', '6 of Diamonds',
            '9 of Clubs', 'Queen of Hearts', '2 of Spades', '5 of Diamonds',
            '8 of Clubs', 'Jack of Hearts', 'Ace of Spades', '4 of Diamonds',
            '7 of Clubs', '10 of Hearts', 'King of Spades', '3 of Diamonds',
            '6 of Clubs', '9 of Hearts', 'Queen of Spades', '2 of Diamonds',
            '5 of Clubs', '8 of Hearts', 'Jack of Spades', 'Ace of Diamonds',
            '4 of Clubs', '7 of Hearts', '10 of Spades', 'King of Diamonds',
            '3 of Clubs', '6 of Hearts', '9 of Spades', 'Queen of Diamonds',
            '2 of Clubs', '5 of Hearts', '8 of Spades', 'Jack of Diamonds'
        ];

        // Populate card dropdown
        const cardSelect = document.getElementById('cardSelect');
        sistebbinsOrder.forEach(card => {
            const option = document.createElement('option');
            option.value = card;
            option.textContent = card;
            cardSelect.appendChild(option);
        });

        // Populate number dropdown
        const numberSelect = document.getElementById('numberSelect');
        for (let i = 1; i <= 52; i++) {
            const option = document.createElement('option');
            option.value = i;
            option.textContent = i;
            numberSelect.appendChild(option);
        }

        async function submitSelection() {
            const card = cardSelect.value;
            const number = numberSelect.value;
            const messageDiv = document.getElementById('message');
            const submitBtn = document.getElementById('submitBtn');

            // Validate selection
            if (!card || !number) {
                messageDiv.textContent = 'Please select both a card and a number';
                messageDiv.className = 'message error';
                messageDiv.style.display = 'block';
                return;
            }

            // Disable button and show loading
            submitBtn.disabled = true;
            submitBtn.textContent = 'Sending...';

            try {
                const response = await fetch(SHEET_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        card: card,
                        number: parseInt(number)
                    })
                });

                // Show success message
                messageDiv.textContent = 'Selection submitted successfully!';
                messageDiv.className = 'message success';
                messageDiv.style.display = 'block';
                submitBtn.textContent = 'Submitted!';

                // Reset form after 2 seconds
                setTimeout(() => {
                    cardSelect.value = '';
                    numberSelect.value = '';
                    messageDiv.style.display = 'none';
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'Submit Selection';
                }, 2000);

            } catch (error) {
                console.error('Error:', error);
                messageDiv.textContent = 'Submission complete';
                messageDiv.className = 'message success';
                messageDiv.style.display = 'block';
                submitBtn.disabled = false;
                submitBtn.textContent = 'Submit Selection';
            }
        }
    </script>
</body>
</html>
